syntax = "proto3";

package kms.api.cmk.registry.auth.v1;

service Service {
  rpc ApplyAuth(ApplyAuthRequest) returns (ApplyAuthResponse) {}
  rpc GetAuth(GetAuthRequest) returns (GetAuthResponse) {}
  rpc RemoveAuth(RemoveAuthRequest) returns (RemoveAuthResponse) {}
}

message Auth {
  string tenant_id = 1;
  string type = 2;
  map<string, string> properties = 3;
  AuthStatus status = 4;
  string error_message = 5;
  string updated_at = 6;
  string created_at = 7;
}

message ApplyAuthRequest {
  string tenant_id = 1;
  string type = 2;
  map<string, string> properties = 3;
}

message ApplyAuthResponse {
  bool success = 1;
}

message GetAuthRequest {
  string tenant_id = 1;
}

message GetAuthResponse {
  Auth auth = 1;
}

message RemoveAuthRequest {
  string tenant_id = 1;
}

message RemoveAuthResponse {
  bool success = 1;
}

enum AuthStatus {
  AUTH_STATUS_UNSPECIFIED = 0;
  AUTH_STATUS_APPLIED = 1;
  AUTH_STATUS_APPLYING = 2;
  AUTH_STATUS_APPLYING_ERROR = 3;
  AUTH_STATUS_REMOVING = 4;
  AUTH_STATUS_REMOVING_ERROR = 5;
  AUTH_STATUS_REMOVED = 6;
}

enum AuthAction {
  AUTH_ACTION_UNSPECIFIED = 0;
  AUTH_ACTION_APPLY_AUTH = 1;
}
