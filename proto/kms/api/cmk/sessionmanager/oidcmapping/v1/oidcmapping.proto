syntax = "proto3";

package kms.api.cmk.sessionmanager.oidcmapping.v1;

service OIDCMappingService {
  rpc ApplyOIDCMapping(ApplyOIDCMappingRequest) returns (ApplyOIDCMappingResponse) {}
  rpc RemoveOIDCMapping(RemoveOIDCMappingRequest) returns (RemoveOIDCMappingResponse) {}
  rpc BlockOIDCMapping(BlockOIDCMappingRequest) returns (BlockOIDCMappingResponse) {}
  rpc UnblockOIDCMapping(UnblockOIDCMappingRequest) returns (UnblockOIDCMappingResponse) {}
}

// apply (create or update) the OIDC provider mapping for the given tenant
message ApplyOIDCMappingRequest {
  string tenant_id = 1;
  string issuer = 2;
  repeated string jwks_uris = 3;
  repeated string audiences = 4;
}

message ApplyOIDCMappingResponse {
  bool success = 1;
  optional string message = 2;
}

// remove the OIDC provider mapping for the given tenant
message RemoveOIDCMappingRequest {
  string tenant_id = 1;
}

message RemoveOIDCMappingResponse {
  bool success = 1;
  optional string message = 2;
}

// block OIDC provider for the given tenant
message BlockOIDCMappingRequest {
  string tenant_id = 1;
}

message BlockOIDCMappingResponse {
  bool success = 1;
  optional string message = 2;
}

// unblock OIDC provider for the given tenant
message UnblockOIDCMappingRequest {
  string tenant_id = 1;
}

message UnblockOIDCMappingResponse {
  bool success = 1;
  optional string message = 2;
}
